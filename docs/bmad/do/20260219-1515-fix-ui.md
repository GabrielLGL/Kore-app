# fix(ui) — add Gemini 429 quota hint in SettingsScreen connection test
Date : 2026-02-19 15:15

## Instruction
Dans mobile/src/screens/SettingsScreen.tsx, améliorer la fonction handleTestConnection
pour ajouter un hint spécifique quand l'erreur Gemini est un 429 (quota dépassé).

## Classification
Type : fix
Fichiers : mobile/src/screens/SettingsScreen.tsx

## Ce qui a été fait
Ajout de `const isGemini429` et d'une branche intermédiaire dans le ternaire `hint`
du bloc catch de `handleTestConnection` (lignes ~103-109).

Avant :
```ts
const isGemini403 = aiProvider === 'gemini' && (errorMessage.includes('403') || errorMessage.includes('API_NOT_ENABLED'))
const hint = isGemini403
  ? '\n\nVérifiez que l\'API Generative Language est activée dans Google Cloud Console.'
  : ''
```

Après :
```ts
const isGemini403 = aiProvider === 'gemini' && (errorMessage.includes('403') || errorMessage.includes('API_NOT_ENABLED'))
const isGemini429 = aiProvider === 'gemini' && errorMessage.includes('429')
const hint = isGemini403
  ? '\n\nVérifiez que l\'API Generative Language est activée dans Google Cloud Console.'
  : isGemini429
    ? '\n\nQuota gratuit dépassé. Attendez quelques secondes et réessayez, ou activez la facturation sur console.cloud.google.com.'
    : ''
```

Aucun autre changement dans le fichier.

## Vérification
- TypeScript : ✅ (npx tsc --noEmit — 0 erreur)
- Tests : ✅ (pas de test unitaire sur ce bloc catch — pas de nouveau test requis)
- Nouveau test créé : non

## Commit
fix(ui): add Gemini 429 quota hint in SettingsScreen connection test
