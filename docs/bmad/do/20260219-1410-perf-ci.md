# perf(ci) ‚Äî Optimiser les tests Jest CI sous 3 minutes
Date : 2026-02-19 14:10

## Instruction
Optimiser le workflow CI GitHub Actions pour que les tests Jest passent sous 3 minutes

## Classification
Type : perf
Fichiers : `mobile/jest.config.js`, `.github/workflows/ci.yml`

## Ce qui a √©t√© fait

### mobile/jest.config.js
Ajout de 2 propri√©t√©s apr√®s `preset: 'jest-expo'` :
- `cacheDirectory: '/tmp/jest-cache'` ‚Äî dirige le cache de transformation Babel vers un chemin persistable
- `maxWorkers: 1` ‚Äî d√©sactive les workers parall√®les (inutiles pour 6 fichiers, co√ªteux en CI)

### .github/workflows/ci.yml
3 modifications :
1. `timeout-minutes: 10 ‚Üí 15` ‚Äî buffer pour le 1er run (remplissage cache)
2. Nouveau step **"üíæ Cache Jest transform"** ins√©r√© entre cache node_modules et install deps :
   - `path: /tmp/jest-cache` (identique √† jest.config.js)
   - `key: ${{ runner.os }}-jest-cache-${{ hashFiles('mobile/jest.config.js', 'mobile/babel.config.js') }}`
   - `restore-keys: ${{ runner.os }}-jest-cache-`
3. `--runInBand` ajout√© √† la commande `npm test`

## V√©rification
- TypeScript : n/a (aucun code TypeScript modifi√©)
- Syntaxe jest.config.js : ‚úÖ `node -e "require('./jest.config.js')"` ‚Üí OK
- Coh√©rence path `/tmp/jest-cache` : ‚úÖ identique dans les 2 fichiers
- Tests : non relanc√©s localement (pas d'impact sur logique de test)

## Gain attendu
- 1er run CI apr√®s merge : ~8-10 min (cache Jest se remplit)
- Runs suivants : ~2-3 min (transforms Babel en cache, runInBand)

## Commit
chore(ci) ‚Üí perf(ci): add Jest transform cache + runInBand to cut test time
