# fix(settings) — Afficher message d'erreur réel lors du test de connexion AI
Date : 2026-02-19 14:30

## Instruction
Améliorer l'affichage des erreurs de connexion AI dans SettingsScreen.tsx :
- Extraire le message d'erreur réel depuis l'objet Error
- Afficher ce message dans l'Alert au lieu du message générique
- Ajouter une aide contextuelle pour Gemini si l'erreur contient "403" ou "API_NOT_ENABLED"

## Classification
Type : fix
Fichiers : mobile/src/screens/SettingsScreen.tsx

## Ce qui a été fait
Modification du bloc `catch` dans `handleTestConnection()` (lignes 100-104) :
- `error instanceof Error ? error.message : 'Erreur inconnue'` pour extraire le message sans `any`
- Alert body : `Impossible de joindre ${aiProvider}.\n\n${errorMessage}${hint}`
- Aide contextuelle Gemini : si provider === 'gemini' ET message contient "403" ou "API_NOT_ENABLED"
  → note : "Vérifiez que l'API Generative Language est activée dans Google Cloud Console."

Aucune modification des autres fonctions ni des fichiers de service.

## Vérification
- TypeScript : ✅ (npx tsc --noEmit — zéro erreur)
- Tests : ✅ 24/24 passed (SettingsScreen.test.tsx)
- Nouveau test créé : non (test existant déjà compatible avec le nouveau comportement)

## Commit
cff2bd5 fix(settings): afficher message d'erreur réel lors du test de connexion AI
